{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://commitmood.dev/schemas/event-v1.json",
  "title": "CommitMood Event v1",
  "type": "object",
  "additionalProperties": false,

  "required": [
    "version",
    "client_id",
    "repo_hash",
    "commit_sha",
    "timestamp",
    "tz_offset_min"
  ],

  "properties": {
    "version": {
      "type": "integer",
      "const": 1,
      "description": "Schema version. Breaking changes must bump this value."
    },

    "client_id": {
      "type": "string",
      "format": "uuid",
      "description": "Stable UUID v4 generated by the CLI on first run; unique per author/device."
    },

    "repo_hash": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "SHA-256 hex digest of the repo's remote URL (hashing keeps repo names private)."
    },

    "commit_sha": {
      "type": "string",
      "pattern": "^[a-f0-9]{7,40}$",
      "description": "Abbreviated or full Git commit SHA."
    },

    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "UTC time the commit was created, ISO-8601 (e.g. “2025-05-21T17:04:33Z”)."
    },

    "tz_offset_min": {
      "type": "integer",
      "minimum": -720,
      "maximum": 840,
      "description": "Developer's local offset from UTC, in minutes -300 = UTC-5)."
    },

    "lines_added": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of lines added in the commit."
    },

    "lines_deleted": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of lines deleted in the commit."
    },

    "files_changed": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of files touched by the commit."
    },

    "session_id": {
      "type": "string",
      "format": "uuid",
      "description": "UUID v4 grouping events that occur within a continuous coding session (≤ 15-minute gaps)."
    },

    "ide": {
      "type": "string",
      "enum": ["vscode", "jetbrains", "vim", "neovim", "emacs", "terminal"],
      "description": "IDE/editor detected by the CLI; omit if unknown."
    }
  },

  "examples": [
    {
      "version": 1,
      "client_id": "4bf6c1c3-6f56-4f9e-8bf2-d0b8123d4e62",
      "repo_hash": "f7dbe0e7fc5d245d6bdbd5326f54b4c14e61591f285d8dbed34d3c9cbc523e1e",
      "commit_sha": "2c1a5e4",
      "timestamp": "2025-05-21T17:04:33Z",
      "tz_offset_min": -240,
      "lines_added": 42,
      "lines_deleted": 10,
      "files_changed": 3,
      "session_id": "a91c7c9b-44a6-4866-b23b-2d090d4a0954",
      "ide": "vscode"
    }
  ]
}
